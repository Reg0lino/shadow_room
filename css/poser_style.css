/* --- Base Styles & Dark Mode Variables (Adapted from style.css) --- */
:root {
    --bg-dark-main: #1a1a1a;
    --bg-dark-controls: #2a2a2a;
    --bg-info-panel: rgba(42, 42, 42, 0.9); /* Slightly transparent dark */
    --text-light: #e0e0e0;
    --text-label-pink: #ff80cc;
    --border-dark: #444;
    --border-light: #ccc;
    --control-bg-dark: #333;
    --button-bg: #4a4a4a;
    --button-border: #666;
    --button-hover-bg: #5a5a5a;
    --list-hover-bg: #383838;
    --list-selected-bg: #004a99; /* Darker blue for selection */
    --error-text: #ff8080;
    --success-text: #80ff80;
}

html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    width: 100%;
    overflow: hidden; /* Prevent scrollbars on body */
    font-family: sans-serif;
    background-color: var(--bg-dark); /* Ensure body background */
}

body {
    display: flex;
    flex-direction: column;
    height: 100%;
}

/* --- Top Controls Bar --- */
#controls {
    flex: 0 0 auto; /* Don't grow or shrink, height determined by content */
    padding: 15px; /* Increased padding */
    background-color: var(--bg-dark-controls);
    border-bottom: 1px solid var(--border-dark);
    display: flex;
    gap: 12px; /* Increased gap */
    align-items: center;
    flex-wrap: wrap; /* Allow controls to wrap */
    position: relative; /* Ensure z-index works reliably */
    z-index: 20; /* Keep above info panel in portrait */
    min-height: 40px; /* Ensure a minimum touchable height */
}

#controls label {
    color: var(--text-label-pink);
    font-size: 1em; /* Slightly larger label font */
}

#controls select,
#controls button {
    padding: 8px 12px; /* Increased padding */
    font-size: 1em; /* Larger font size */
    background-color: var(--button-bg);
    color: var(--text-light);
    border: 1px solid var(--button-border);
    border-radius: 4px; /* Slightly larger radius */
    cursor: pointer;
    min-height: 38px; /* Ensure minimum button height */
    box-sizing: border-box;
}
#controls select {
     appearance: none;
     background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23CCCCCC%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.3-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.4-12.8z%22%2F%3E%3C%2Fsvg%3E');
     background-repeat: no-repeat; background-position: right 12px top 50%; background-size: .75em auto; padding-right: 35px; /* Adjust padding for larger arrow */
}


#controls button:hover {
    background-color: var(--button-hover-bg);
}

#controls button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

#controls button.active { /* Style for active transform button */
    background-color: var(--list-selected-bg);
    border-color: var(--text-label-pink);
}

#transformModeControls {
    display: flex;
    gap: 8px; /* Increased gap */
    align-items: center;
    margin-left: 15px; /* Increased margin */
}
#transformModeControls span {
    font-size: 1em; /* Match button font size */
}


/* --- Main 3D View Container --- */
#container {
    flex: 1 1 auto; /* Allow container to grow and shrink, taking remaining space */
    position: relative; /* Crucial for absolute positioning of children */
    overflow: hidden; /* Prevent internal scrollbars if content overflows */
    display: flex; /* Use flex for potential internal layout */
    min-height: 0; /* Prevent flex item from overflowing body in some cases */
    background-color: #cccccc; /* Default light background for contrast */
    min-width: 0;
}

canvas {
    display: block;
    width: 100% !important;
    height: 100% !important;
}

/* --- Info Overlay (Top Left) --- */
#info {
    position: absolute;
    top: 10px;
    left: 10px;
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 8px 15px;
    border-radius: 5px;
    z-index: 10; /* Below controls, above components */
    font-size: 0.9em;
    max-width: calc(100% - 30px); /* Prevent overlap with potential sidebar */
    border: 1px solid var(--border-dark);
}

#info.error {
    background-color: rgba(180, 0, 0, 0.8);
}

#info.success {
    background-color: rgba(0, 128, 0, 0.8);
}

#info.loading {
    background-color: rgba(0, 0, 128, 0.8);
}


/* --- Components Info Panel (Right/Bottom) --- */
#componentsInfo {
    position: absolute; /* Position relative to #container */
    background: var(--bg-info-panel);
    color: var(--text-light);
    padding: 10px;
    border-radius: 5px;
    z-index: 15; /* Above #info if overlapping, below #controls */
    box-sizing: border-box;
    overflow-y: auto;
    display: none; /* Initially hidden, controlled by JS */

    /* Default (Portrait / Mobile First): Positioned at Bottom */
    bottom: 0;
    left: 0;
    right: 0;
    height: 33vh; /* Approx 1/3 of viewport height */
    border-top: 1px solid var(--border-dark);
    border-left: none;
    border-right: none;
    border-bottom: none;
    border-radius: 5px 5px 0 0; /* Rounded top corners */
}

#componentsInfo h3, #componentsInfo h4 {
    margin-top: 0;
    margin-bottom: 8px;
    font-size: 1em;
    color: var(--text-heading-purple);
    border-bottom: 1px solid var(--border-dark);
    padding-bottom: 4px;
}
#componentsInfo h4 {
    font-size: 0.9em;
    color: var(--text-label-pink);
    margin-top: 15px;
}

#componentsInfo ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

#componentsInfo li {
    margin-bottom: 5px;
    padding: 4px 6px;
    border-bottom: 1px solid var(--border-dark);
    word-wrap: break-word;
    cursor: pointer;
    font-size: 0.85em;
    transition: background-color 0.2s ease;
}

#componentsInfo li:hover {
    background-color: var(--list-hover-bg);
}

#componentsInfo li.selected {
    background-color: var(--list-selected-bg);
    font-weight: bold;
    color: white;
}

#componentsInfo li.error {
    color: var(--error-text);
    font-style: italic;
}

#componentsInfo details > summary {
    cursor: pointer;
    font-weight: bold;
    margin: 5px 0;
    padding: 4px 6px;
    background-color: var(--button-bg);
    border-radius: 3px;
    font-size: 0.9em;
    transition: background-color 0.2s ease;
}
#componentsInfo details > summary:hover {
    background-color: var(--button-hover-bg);
}
#componentsInfo details[open] > summary {
     background-color: var(--list-selected-bg);
     color: white;
}
#componentsInfo details ul { /* Indent finger list */
    margin-left: 15px;
    margin-top: 5px;
}


/* ====================================================== */
/* --- Landscape Layout Adjustments --- */
/* ====================================================== */

/* Landscape - General (Applies to phones/tablets in landscape) */
@media screen and (orientation: landscape) {
    #componentsInfo {
        /* Keep at bottom, but reduce height */
        height: 30vh; /* Make slightly shorter in landscape */
        /* Ensure width is still full */
        left: 0;
        right: 0;
        top: auto; /* Ensure top is not set */
        width: auto; /* Ensure width is not fixed */
        border-left: none; /* Remove potential side border */
        border-radius: 5px 5px 0 0; /* Keep top rounded corners */
    }
}

/* Landscape - Larger Screens (Sidebar layout) */
/* Only apply sidebar layout if there's enough width */
@media screen and (orientation: landscape) and (min-width: 768px) {
    /* --- REMOVE body flex-direction change --- */
    /*
    body {
        flex-direction: row;
    }
    */

    /* --- REMOVE controls order change --- */
    /*
    #controls {
        order: -1;
    }
    */

    /* --- Ensure container takes space correctly (already set outside media query) --- */
    /* #container should already have flex: 1 1 auto; */


    /* Components Info becomes a right sidebar in landscape */
    #componentsInfo {
        /* Keep absolute positioning relative to #container */
        position: absolute;
        top: 10px;
        right: 10px;
        bottom: 10px; /* Adjust bottom */
        left: auto; /* Reset left */
        width: 280px; /* Fixed width sidebar */
        height: auto; /* Height determined by top/bottom */
        max-height: none; /* Ensure no max-height limit in landscape */
        border-top: none;
        border-left: 1px solid var(--border-dark); /* Add left border */
        border-radius: 5px; /* Standard border radius */
    }
}